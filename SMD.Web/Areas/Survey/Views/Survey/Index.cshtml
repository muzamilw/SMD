@{
    ViewBag.Title = "Manage Surveys";

    string sLayout = "";
    if (Request.QueryString["m"] == "1")
    {
        sLayout = "~/Views/Shared/_Layout_Franchise.cshtml";
    }
    else
    {
        sLayout = "~/Views/Shared/_Layout.cshtml";
    }

    Layout = sLayout;

    string adminClasses = "";
    string userClasses = "";
}

@if (!User.IsInRole("User"))
{
    userClasses = "displayNone";
}
else
{
    adminClasses = "displayNone";
}
<div class="row" id="Heading_div">
    <div class="col-lg-12" style="padding-left: 0px;padding-right:0px;">
        <div style="width:100px;" class="pull-left">
            <img class="vid_image pull-left" src="/Content/Images/Pollmod.png" style="display: block;margin-left:-5px;">
            <label id="headlabel" style="font-size:24px;color:#fff!important;margin-top:0px;padding-top:11px;margin-left:5px;">Poll</label>
        </div>
        <div style="width:5px;">
        </div>
        <div style="width: 1049px;" class="pull-left">

            <label id="headdesc" style="color:#fff;font-size:14px;margin-top:15px;display:none">Run a 2 picture card poll to a target audience.</label>
            <img class="pull-right closecls" src="~/Content/Images/Close_Button.png" style="margin-top:19px;" onclick="GotoHome();" />
            <div class="clearfix"></div>
        </div>
        <div class="clearfix;"></div>
    </div>
</div>
<div class="row" id="surveyBinding" style="margin-top: 0px;">
    <div class="col-lg-12" data-bind="visible: !$root.isEditorVisible()">
        <div class="row">
            <div class="col-lg-12" style="padding-left:0px;padding-right:9px;padding-bottom:10px;">
                <!-- ko template: { name: 'filterTemplate' } -->
                <!-- /ko -->
                <div data-bind="visible: $root.questions().length > 0">
                    <div class="main-box no-header clearfix margintop13" style="padding-top:0px;">
                        <div class="main-box-body clearfix" style="padding-left:20px;padding-right:22px;">
                            <div class="tabsdescriptions" style="margin-left:0px;">
                                <p class="group-header-description"></p>
                            </div>
                            <div class="table-responsive" style="margin-right:-4px;">
                                <table class="table table-striped table-hover tbl-intialAlign" id="surveyQuestionLVTable">
                                    <thead>
                                        <tr>
                                            <th class="col-lg-4 th-pointer"><span class="GridHeaderFont_size">Poll Name</span></th>
                                            <th class="col-lg-1 th-pointer"><span class="GridHeaderFont_size">Start Date</span></th>
                                            <th class="col-lg-1 th-pointer"><span class="GridHeaderFont_size">Answered</span></th>
                                            <th class="col-lg-1 th-pointer"><span class="@adminClasses GridHeaderFont_size">Delivered %</span></th>
                                            <th class="col-lg-5 th-pointer" colspan="3"><span>&nbsp; </span></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <!-- ko template: { name: 'SurveyQuestionTemplate' , foreach: questions } -->
                                        <!-- /ko -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div id="pagerDivForStore" class="pull-right">
                        <!-- ko with: pager -->
                        @Html.Partial("~/Areas/Common/Views/Shared/_Pager.cshtml")
                        <!-- /ko -->
                    </div>
                </div>

                <div data-bind="visible: ($root.questions().length == 0 && $root.gridTotalCount() == 0)" style="display:none;">
                    <div class="clearfix" style="padding:20px;padding-bottom:15px;">
                        <div class="col-lg-5"></div>
                        <span style="color:white">You haven’t created any Polls yet</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row Subpanels" style="margin-right:1px;padding-top:0px;">
            <div class="col-lg-12">

                <div class="col-lg-6" style="padding-top:20px;padding-left:15px;" data-bind="visible:($root.questions().length==0 && $root.gridTotalCount() == 0)">
                    <div class=" row">
                        <span style="font-size:20px;">Learn what your customers prefer</span>
                    </div>
                    <div class="row center">
                        <img src="/Images/Share_world.png">
                    </div>
                </div>
                <div class="col-lg-6" style="padding-top:20px;padding-left:15px;display:none;" data-bind="visible:$root.questions().length>0">
                    <div class="row" style="padding-bottom:10px;">
                        <span style="font-size:20px;margin-left:5px;">Here’s some Picture Polls targeted near you</span>
                    </div>
                    <div class="row center">
                        <div class="col-lg-4">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.leftPollImg1()}">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.righPolltImg1()}">
                            <div class=" main-box no-header clearfix text-center" style="padding:8px;margin-top:1px;margin-right:23px;">
                                <span style="font-size:12px;font-weight:bold;" data-bind="text:$root.pollQuestion1"></span>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.leftPollImg2()}">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.righPolltImg2()}">
                            <div class=" main-box no-header clearfix text-center" style="padding:8px;margin-top:1px;margin-right:23px;">
                                <span style="font-size:12px;font-weight:bold" data-bind="text:$root.pollQuestion2"></span>
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.leftPollImg3()}">
                            <img style="height:140px;width:70px;" data-bind="attr:{src:$root.righPolltImg3()}">
                            <div class=" main-box no-header clearfix text-center" style="padding:8px;margin-top:1px;margin-right:23px;">
                                <span style="font-size:12px;font-weight:bold" data-bind="text:$root.pollQuestion3"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row" style="padding-top:0px;padding-left:8px;padding-bottom:16px;">
                        <a href="http://cash4ads.com/" target="_blank">
                            More...
                        </a>
                    </div>
                </div>

                <div class="col-lg-6" style="padding-top:20px;">
                    <div class="row" style="padding-bottom:10px;">
                        <span style="font-size:20px;">Chart Customer Journeys</span>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <ul style="list-style-type:circle;margin-left:17px;">
                                <li>Target Polls to potential customers near you</li>
                                <li>Use Poll results to refine your targeting in future video ad campaigns</li>
                                <li>Combine Poll results with Survey questions to define Target Audience sets</li>
                                <li>Upload 2 pictures to identify user preferences</li>
                            </ul>
                        </div>
                    </div>
                    <div class="row" style="padding-bottom:30px;margin-top:58px;">
                        <span style="color:#3498db;font-family:'Gloria Hallelujah',cursive;">Start getting Poll results today !</span>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <script id="SurveyQuestionTemplate" type="text/html">

        <tr style="cursor: pointer">
            <td>
                <a href="#" class="store-user-link" data-bind="text: Question,click:$root.onEditSurvey"></a>
            
                <br />
                <img style="width:70px;height:140px;" data-bind="attr: { src:  LeftPicturePath()   }"> &nbsp;&nbsp;<img style="width:70px;height:140px;" data-bind="attr: { src:  RightPicturePath()   }">
                <br />
                <!-- ko if: StartDate()-->
                <span style="color:darkgray;font-size:11px;">
                    Start Date :
                </span>
                <span style="color:darkgray;font-size:11px;" data-bind="dateTimeString:  StartDate()"></span>
                <!-- /ko -->
                <!-- ko if: StartDate()== null -->
                <span style="color:darkgray;font-size:11px;">
                    Not Started
                </span>

                <!-- /ko -->
                <!-- ko if: ModifiedDate()-->
                <br />
                <span style="color:darkgray;font-size:11px;">
                    Last Updated :
                </span>

                <span style="color:darkgray;font-size:11px;" data-bind="dateTimeString:  ModifiedDate()"></span>
                <!-- /ko -->


            </td>
            <td>
                <p data-bind="dateString:StartDate"></p>
            </td>
            @*<td>
                    <p data-bind="dateString:EndDate" class="@userClasses"></p>
                </td>*@
            <td>
                <p data-bind="text:resultClicks"></p>
            </td>
            <td style="color:blue;font-size:larger;font-weight:bold">
                <span data-bind="text:CreatedBy" class="@adminClasses"></span>%
            </td>
            <td >

                <div style="font-size:small" data-bind="text:Question()"></div>
                <br />
                <div data-bind="morris: {type: 'Donut', data:PieChartData , resize:true, colors: ['green', 'blue' ]  }" style="height:150px;cursor:pointer;"></div>       
                @*<!-- ko if: Answer3() != null -->
                <div data-bind="morris: {type: 'Donut', data: [{label: Answer1(), value: Answer1Stats()},{label: Answer2(), value: Answer2Stats()},{label: Answer3(), value: Answer3Stats()}], resize:true, colors: ['green', 'blue','red' ]  }" style="height:230px;cursor:pointer;"></div>
                <!-- /ko -->
                <!-- ko if: Answer3() == null -->
                <div data-bind="morris: {type: 'Donut', data: [{label: Answer1(), value: Answer1Stats()},{label: Answer2(), value: Answer2Stats()}], resize:true, colors: ['green', 'blue','red' ]  }" style="height:230px;cursor:pointer;"></div>
                <!-- /ko -->*@
            </td>
            <td >
                
                <table class="tbl-noborder">
                    <tbody>
                        <!-- ko if: PieChartData()[0] == undefined -->
                        <tr>
                            <td><br /><br /><br /></td>
                            <td></td>
                        </tr>
<tr>
                            <td>

                                <span> Result 1</span>
                            </td>
                            <td>
                                <span >0</span>%
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <span> Result 2</span>
                            </td>
                            <td>
                                <span>0</span>%
                            </td>
                        </tr>
                        <!-- /ko -->
                        <!-- ko if: PieChartData()[0] != undefined -->
                        
                        <tr>
                            <td>
                                <span data-bind="text: 'Result ' + PieChartData()[0].label"> </span>
                            </td>
                            <td>
                                <span data-bind="text:((PieChartData()[0].value/resultClicks())*100).toFixed(2)"></span>%
                            </td>
                        </tr>
                        <!-- /ko -->
                        <!-- ko if: PieChartData()[1] != undefined -->
                        <tr>
                            <td>
                                <span data-bind="text: 'Result ' + PieChartData()[1].label"> </span>
                            </td>
                            <td>
                                <span data-bind="text:((PieChartData()[1].value / resultClicks())*100).toFixed(2)"></span>%
                            </td>
                        </tr>
                        <!-- /ko -->
                    </tbody>
                </table>
            </td>
            <td>

                <div style="font-size:larger;font-weight:bold;">
                    <!-- ko if: Status() == 1-->
                    <span style="color:#6D6EFA; " data-bind="text: StatusValue">
                    </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 2-->
                        <span style="color:#fc0" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if:  Status() == 3-->
                        <span style="color:#37c675" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 4-->
                        <span style="color:#fd008e" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 5-->
                        <span style="color:#c8e392" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 6-->
                        <span style="color:red" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 7-->
                        <span style="color:red" data-bind="text: 'Remove'">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 8-->
                        <span style="color:#fc0" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    <!-- ko if: Status() == 9-->
                        <span style="color:red" data-bind="text: StatusValue">
                        </span>
                    <!-- /ko -->
                    </div>
                    <br />
                    <div class="text-left statusbg" data-bind="click:$root.onEditSurvey" style="background:#37c675;width:95px;white-space:nowrap;">
                        <span>
                            Edit Campaign
                        </span>

                    </div>
                    <br />
                    <div class="text-left statusbg" data-bind="click:$root.openAdvertiserDashboardPollScreen" style="background:blue;width:95px;white-space:nowrap;">
                        <span>
                            Analyze Charts
                        </span>
                    </div>
                <br />
                <div style="text-align: left;padding-left:30px;">
                    <!-- ko if: Status() == 1 ||  Status() == 4|| Status() ==  6-->
                    <a class="table-link danger">
                        <span class="fa-stack">
                            <i class="fa fa-square fa-stack-2x"></i>
                            <i class="fa fa-trash-o fa-stack-1x fa-inverse " data-bind="click:$root.terminateSaveChanges"></i>
                        </span>
                    </a>

                    <!-- /ko -->
                </div>
</td>
            @*<td>
                <!-- ko if: Status() == 1 ||  Status() == 4|| Status() ==  6-->
                <a class="table-link danger" style="float: right">
                    <span class="fa-stack">
                        <i class="fa fa-square fa-stack-2x"></i>
                        <i class="fa fa-trash-o fa-stack-1x fa-inverse " data-bind="click:$root.terminateSaveChanges"></i>
                    </span>
                </a>
                <!-- /ko -->
            </td>*@
        </tr>
    </script>
    <script id="filterTemplate" type="text/html">
        <div class="filter-body" id="filter">
            <div class="row" style="display:none;">

                <div class="col-sm-12" style="float: left; margin-bottom:20px;">
                    <div>
                        <span style="font-size:18px; color:#81d3dc;float:left;margin-top:17px;">Picture survey</span>
                        <button class="btn btn-primary btnclick FloatRight" data-bind="click:$root.addNewSurvey" style="float:right;margin-top:2px; text-align:right">
                            Create Survey Card
                        </button>
                        <div style="clear:both;"></div>
                    </div>

                    <span class="red bold rightAlign" style=" margin-right: 14px;margin-top:-11px!important;display:none;"> Watch Video <img src="/Images/youtube_play.JPG" height="25px" /> </span> <span style="font-size: 14px;margin-right:8px;" class="Theme_subheading-Clr">Run a 2 picture card survey and create a new target audience groups <br />that can be used in any of your video or display ads campaigns.</span>&nbsp; &nbsp; &nbsp;<br />
                </div>

            </div>
            <div class="row">

                <form data-bind="submit:$root.filterSurveyQuestion">
                    <div class="filter-block" >
                        <div id="filterdd">
                            <div class="form-group">
                                <div class="col-xs-2">
                                    <div data-bind="visible:$root.isPollSearch()==false">
                                        <input type="text" class="form-control" placeholder="Search..." data-bind="value:$root.filterValue">
                                        <i data-bind="click:$root.filterSurveyQuestion" class="fa fa-search search-icon" style=" margin-right: 8px;"></i>
                                    </div>

                                </div>
                                <div class="col-xs-2">
                                    <select class="form-control" data-bind="options: $root.qStatuses, optionsText: 'value', optionsValue: 'id',value:$root.statusFilterValue,event:{ change: $root.SurveyQuestionsByFilter},visible:$root.isPollSearch()==false"></select>
                                </div>

                            </div>
                        </div>
                    </div>
                </form>
                <div>
                    <div class="col-sm-3 filterbloclkspos" style="float:left;font-size: 20px;margin-top:6px;padding-left:70px;">
                        <span data-bind="visible:$root.islblText()==true">DIY Market Research</span>

                    </div>
                    <div class="col-sm-2">
                        <img data-bind="visible:$root.islblText()==true" src="/Images/Arrow.png" style="height:35px;">
                    </div>
                </div>
                <div class="col-xs-3" style="padding:0px;text-align:right;">
                    @*<button class="btn  btn-info SurvyButtons" id="saveBtn" data-bind="click:$root.filterProfileQuestion" style="display:none!important;">Search</button>
                        <button class="btn btn-default SurvyButtons" id="saveBtn" data-bind="click:$root.clearFilters" style="display:none!important;">Reset</button>*@

                    <button class="btn btn-primary btnclick FloatRight create_polls_btn" data-bind="click:$root.addNewSurvey" style="float:right;margin-top:2px; text-align:right">
                        Create Poll
                    </button>
                </div>
                <div class="clearfix">
                </div>
            </div>
        </div>
    </script>
    @{
        Html.RenderPartial("~/Areas/Survey/Views/Shared/_AddEditSurvey.cshtml");
    }
</div>

<script>

    $("#polls_heading").css("cssText", "color:#fff!important;");

</script>
<!-- ko stopBinding: true -->
@Html.Partial("~/Areas/Common/Views/Shared/_StripeChargeCustomerDialog.cshtml")
<!-- /ko -->
<!-- ko stopBinding: true -->
@Html.Partial("~/Areas/Common/Views/Shared/_ConfirmationDialog.cshtml")
<!-- /ko -->
@section Scripts{
    <script src="~/Scripts/jquery.tokenize.js"></script>
    <script type="text/javascript">
        //$("#MainSpan").css("display", "none");
        require(["survey/survey.view", "common/confirmation.view", "common/stripeChargeCustomer.view"]);
        $("#btnSurvey").css("background-color", "#34b9c7");
        $("#btnManageApprov").css("background-color", "#34b9c7");
        $("#main_btnPannels").css("display", "none");
        $("#MarketobjDiv").css("display", "none");
        $(".hideInCoupons").css("display", "none");
        $("#topArea").css("display", "none");
        $("#divApprove").css("display", "none");
        $(".dash_slide_panel").css("display", "none");
    </script>

}